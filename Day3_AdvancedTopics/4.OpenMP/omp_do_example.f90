PROGRAM VEC_ADD_DO

  INTEGER N, CHUNKSIZE, CHUNK, I, TID, OMP_GET_THREAD_NUM
  PARAMETER (N=1000) 
  PARAMETER (CHUNKSIZE=100) 
  REAL A(N), B(N), C(N)

  !     Some initializations
  DO I = 1, N
     A(I) = I * 1.0
     B(I) = A(I)
  ENDDO
  CHUNK = CHUNKSIZE

  !$OMP PARALLEL SHARED(A,B,C,CHUNK) PRIVATE(I, TID)
  TID = OMP_GET_THREAD_NUM()
  !$OMP DO SCHEDULE(DYNAMIC,CHUNK)
  DO I = 1, N
     WRITE(*,*) 'Thread: ', TID, ' Working on I=', I
     C(I) = A(I) + B(I)
  ENDDO
  !$OMP END DO NOWAIT

  !$OMP END PARALLEL

END PROGRAM VEC_ADD_DO
